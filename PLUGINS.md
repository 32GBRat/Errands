# DO NOT USE!!!  NOT READY YET!!!  WORK IN PROGRESS!!!

# Plugins development for Errands

## Overview

Plugin is a folder inside `plugins` folder at:
- `~/.var/app/io.github.mrvladus.List/data/errands/plugins` for Flatpak installation
- `~/.local/share/errands/plugins` for other packages

Plugin structure for Errands looks like this:
```
plugins/
    my_plugin/
        dependencies/
        plugin.py
        requirements.txt
        LICENSE
    other_plugin/
    ...
```
### Plugin name
Name of the plugin folder must follow `snake_case`.

### Plugin entry point
Plugin entry point is `plugin.py` file. Plugin loader is searching for this file. Content of this file must follow certain structure, described below.

### Plugin folder structure
You can make any structure you want as regular python package, this includes use of multiple files and folders. The only reserved folder name is `dependencies`.

### Dependencies
Plugins can have their own dependencies.
All of the plugin's dependencies, that can be installed using pip must be listed in `requirements.txt`.
This file is **optional**.
This is regular `requirements.txt` that is used in all python projects and can be generated by `pip freeze`.
`dependencies` folder is created during first plugin loading if `requirements.txt` is exists. All dependencies is installed to this folder by plugin loader.

### License
This file is **optional**.

## Creating new plugin

### Creating repository
- Create new git repository. Name should follow `snake_case`.
- Create file `plugin.py`.
- Optionally create file `requirements.txt`.
- Optionally create file `LICENSE`.
- Publish new repo on **GitHub** or **GitLab**.

### Creating plugin.py
Basic `plugin.py` file should look like this:

```python
from errands.lib.plugins import PluginBase
from errands.application import ErrandsApplication

class Plugin(PluginBase):
    def initialize(app: ErrandsApplication):
        self.app = app
        print("Hello from my new plugin!")
```

First, we import base class for plugins:
```python
from errands.lib.plugins import PluginBase
```

Then we create `Plugin` class that inherits from base class:
```python
class Plugin(PluginBase):
    def initialize(app: ErrandsApplication):
        self.app = app
        print("Hello from my new plugin!")
```
This will be entry point of the our plugin. Plugin loader is looking for `Plugin` class.

It must implement several methods:

#### initialize(app: ErrandsApplication)
It receives `ErrandsApplication` instance `app`.

So that's why we import it for IDE completions.
```python
from errands.application import ErrandsApplication
```
It's point of access to the Errands widget tree. If we want to exend functionality of specific component we will be accessing it with `self.app`.

You can use Errands source code for searching of component to extend. In source code public widgets is inside classes before `__init__` method and marked with comment `# Public elements`.

Currently widget tree looks like this (may not be up to date):
```
application
    window
        about_window
        split_view
            sidebar
                header_bar
                    add_list_btn
                    sync_indicator
                    menu_btn
                status_page
                task_lists
                    lists
                        lists_item
                trash_button
            stack
                trash
                task_list_page
                    split_view
                        details
                        task_list
                            entry
                            task

```